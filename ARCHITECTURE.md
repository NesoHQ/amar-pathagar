# Amar Pathagar - System Architecture

## ðŸ—ï¸ High-Level Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        FRONTEND                              â”‚
â”‚                   (React + TypeScript)                       â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚Dashboard â”‚  â”‚  Books   â”‚  â”‚Donations â”‚  â”‚Leaderboardâ”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Profile  â”‚  â”‚My Libraryâ”‚  â”‚  Ideas   â”‚  â”‚ Reviews  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                              â”‚
â”‚                    â†• HTTP/REST API â†•                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         BACKEND                              â”‚
â”‚                      (Go + Gin Framework)                    â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    API HANDLERS                         â”‚ â”‚
â”‚  â”‚  Auth â”‚ User â”‚ Book â”‚ Idea â”‚ Review â”‚ Donation â”‚ etc.  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â†“                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                   BUSINESS LOGIC                        â”‚ â”‚
â”‚  â”‚  SuccessScore â”‚ Matching â”‚ Notification â”‚ Auth Service â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â†“                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                   REPOSITORIES                          â”‚ â”‚
â”‚  â”‚  User â”‚ Book â”‚ Idea â”‚ Review â”‚ Donation â”‚ Bookmark     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â†“                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       DATABASE                               â”‚
â”‚                      (PostgreSQL 15)                         â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  users   â”‚  â”‚  books   â”‚  â”‚  ideas   â”‚  â”‚ reviews  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚donations â”‚  â”‚bookmarks â”‚  â”‚ requests â”‚  â”‚ history  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚ notifs   â”‚  â”‚  scores  â”‚  â”‚  audits  â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ðŸ”„ Request Flow

### 1. User Requests a Book

```
User (Frontend)
    â”‚
    â”œâ”€â†’ POST /api/books/:id/request
    â”‚
    â†“
Handler (book_handler.go)
    â”‚
    â”œâ”€â†’ Check user eligibility (success_score >= 20)
    â”‚
    â”œâ”€â†’ Get book and holder location
    â”‚
    â†“
Matching Service
    â”‚
    â”œâ”€â†’ Calculate distance (Haversine formula)
    â”‚
    â”œâ”€â†’ Calculate interest match
    â”‚
    â”œâ”€â†’ Compute priority score
    â”‚       = (SuccessScore Ã— 0.4) 
    â”‚       + (InterestMatch Ã— 0.3)
    â”‚       + (DistanceScore Ã— 0.3)
    â”‚
    â†“
Repository
    â”‚
    â”œâ”€â†’ Create book_request record
    â”‚
    â”œâ”€â†’ Update book status to 'requested'
    â”‚
    â†“
Notification Service
    â”‚
    â”œâ”€â†’ Notify current holder
    â”‚
    â””â”€â†’ Notify requester (confirmation)
```

### 2. Admin Approves Request

```
Admin (Frontend)
    â”‚
    â”œâ”€â†’ POST /api/requests/:id/approve
    â”‚
    â†“
Handler
    â”‚
    â”œâ”€â†’ Get best match (highest priority_score)
    â”‚
    â”œâ”€â†’ Update request status to 'approved'
    â”‚
    â”œâ”€â†’ Reject other pending requests
    â”‚
    â†“
Book Service
    â”‚
    â”œâ”€â†’ Assign book to winner
    â”‚
    â”œâ”€â†’ Set due date
    â”‚
    â”œâ”€â†’ Create reading_history entry
    â”‚
    â†“
Notification Service
    â”‚
    â”œâ”€â†’ Notify winner (approved)
    â”‚
    â””â”€â†’ Notify others (rejected)
```

### 3. User Returns Book

```
User (Frontend)
    â”‚
    â”œâ”€â†’ POST /api/books/:id/return
    â”‚
    â†“
Handler
    â”‚
    â”œâ”€â†’ Check return date vs due date
    â”‚
    â”œâ”€â†’ Update reading_history (end_date)
    â”‚
    â†“
Success Score Service
    â”‚
    â”œâ”€â†’ If on time: +10 points
    â”‚
    â”œâ”€â†’ If late: -15 points
    â”‚
    â”œâ”€â†’ Record in success_score_history
    â”‚
    â†“
Book Service
    â”‚
    â”œâ”€â†’ Update book status to 'available'
    â”‚
    â”œâ”€â†’ Clear current_holder
    â”‚
    â†“
Notification Service
    â”‚
    â”œâ”€â†’ Notify users in queue
    â”‚
    â””â”€â†’ Notify user (score change)
```

## ðŸ§© Component Interactions

### Success Score System

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              SUCCESS SCORE TRIGGERS                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                 â”‚                 â”‚
        â†“                 â†“                 â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Return â”‚       â”‚ Review â”‚       â”‚  Idea  â”‚
   â”‚  Book  â”‚       â”‚  User  â”‚       â”‚  Vote  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                 â”‚                 â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ SuccessScoreService   â”‚
              â”‚  - Calculate change   â”‚
              â”‚  - Update user score  â”‚
              â”‚  - Record history     â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ NotificationService   â”‚
              â”‚  - Notify user        â”‚
              â”‚  - Show score change  â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Matching Algorithm

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              BOOK REQUEST MATCHING                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                 â”‚                 â”‚
        â†“                 â†“                 â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚Locationâ”‚       â”‚Success â”‚       â”‚Interestâ”‚
   â”‚  Data  â”‚       â”‚ Score  â”‚       â”‚ Match  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                 â”‚                 â”‚
        â”‚ (30%)           â”‚ (40%)           â”‚ (30%)
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   MatchingService     â”‚
              â”‚  - Calculate distance â”‚
              â”‚  - Match interests    â”‚
              â”‚  - Compute priority   â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   Select Best Match   â”‚
              â”‚  - Highest priority   â”‚
              â”‚  - Earliest request   â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ðŸ“Š Data Flow Diagram

### Reading Idea Lifecycle

```
User writes idea
      â”‚
      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Create Idea  â”‚ â”€â”€â†’ +3 points to author
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Store in DB  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Display to   â”‚
â”‚ Community    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â”œâ”€â”€â†’ User A upvotes â”€â”€â†’ +1 point to author
      â”‚
      â”œâ”€â”€â†’ User B upvotes â”€â”€â†’ +1 point to author
      â”‚
      â””â”€â”€â†’ User C downvotes â”€â”€â†’ -1 point to author
```

### Review Lifecycle

```
User A has book
      â”‚
      â†“
User B receives book
      â”‚
      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User B writesâ”‚
â”‚ review for A â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â”œâ”€â”€â†’ Behavior: 5/5
      â”œâ”€â”€â†’ Condition: 4/5
      â””â”€â”€â†’ Communication: 5/5
      â”‚
      â†“
Calculate average: 4.67
      â”‚
      â”œâ”€â”€â†’ If >= 4.0: +5 points to User A
      â””â”€â”€â†’ If < 3.0: -10 points to User A
```

## ðŸ” Security Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SECURITY LAYERS                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. Authentication Layer
   â”œâ”€â†’ JWT tokens (access + refresh)
   â”œâ”€â†’ Password hashing (bcrypt)
   â””â”€â†’ Token validation middleware

2. Authorization Layer
   â”œâ”€â†’ Role-based access (admin/member)
   â”œâ”€â†’ Resource ownership checks
   â””â”€â†’ Success score requirements

3. Data Layer
   â”œâ”€â†’ SQL injection prevention (parameterized queries)
   â”œâ”€â†’ Input validation
   â””â”€â†’ XSS protection

4. Audit Layer
   â”œâ”€â†’ All actions logged
   â”œâ”€â†’ User activity tracking
   â””â”€â†’ Success score history
```

## ðŸ—„ï¸ Database Schema Relationships

```
users â”€â”€â”¬â”€â”€< reading_history
        â”œâ”€â”€< book_requests
        â”œâ”€â”€< reading_ideas
        â”œâ”€â”€< idea_votes
        â”œâ”€â”€< user_reviews (as reviewer)
        â”œâ”€â”€< user_reviews (as reviewee)
        â”œâ”€â”€< donations
        â”œâ”€â”€< user_interests
        â”œâ”€â”€< user_bookmarks
        â”œâ”€â”€< notifications
        â””â”€â”€< success_score_history

books â”€â”€â”¬â”€â”€< reading_history
        â”œâ”€â”€< book_requests
        â”œâ”€â”€< reading_ideas
        â”œâ”€â”€< user_bookmarks
        â””â”€â”€< waiting_queue

reading_ideas â”€â”€< idea_votes

Indexes:
â”œâ”€â†’ users(success_score) - Leaderboard queries
â”œâ”€â†’ users(location_lat, location_lng) - Distance calculations
â”œâ”€â†’ books(status) - Availability queries
â”œâ”€â†’ book_requests(priority_score) - Matching algorithm
â””â”€â†’ notifications(user_id, is_read) - Notification queries
```

## ðŸ”„ State Transitions

### Book Status Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Available â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
     â”‚                          â”‚
     â”‚ User requests            â”‚ User returns
     â†“                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚Requested â”‚                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
     â”‚                          â”‚
     â”‚ Admin approves           â”‚
     â†“                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚ Reading  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Request Status Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Pending â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”œâ”€â”€â†’ Admin approves â”€â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                       â”‚ Approved â”‚
     â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”œâ”€â”€â†’ Admin rejects â”€â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                      â”‚ Rejected â”‚
     â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â””â”€â”€â†’ User cancels â”€â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚Cancelled â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ðŸš€ Deployment Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PRODUCTION SETUP                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Internet
    â”‚
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CDN    â”‚ (Static assets)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Nginx   â”‚ (Reverse proxy, SSL)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”œâ”€â”€â†’ Frontend (React SPA)
    â”‚
    â””â”€â”€â†’ Backend API (Go)
              â”‚
              â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚PostgreSQLâ”‚ (Primary)
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚PostgreSQLâ”‚ (Replica - Read)
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ðŸ“ˆ Scalability Considerations

### Horizontal Scaling

```
Load Balancer
    â”‚
    â”œâ”€â”€â†’ Backend Instance 1
    â”œâ”€â”€â†’ Backend Instance 2
    â””â”€â”€â†’ Backend Instance 3
              â”‚
              â†“
         Database Pool
              â”‚
              â”œâ”€â”€â†’ Primary (Write)
              â””â”€â”€â†’ Replicas (Read)
```

### Caching Strategy

```
Request
    â”‚
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Redis   â”‚ (Session, frequently accessed data)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â”‚ Cache miss
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚PostgreSQLâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ðŸ” Monitoring & Observability

```
Application
    â”‚
    â”œâ”€â”€â†’ Logs â”€â”€â†’ Log Aggregation (ELK Stack)
    â”‚
    â”œâ”€â”€â†’ Metrics â”€â”€â†’ Prometheus + Grafana
    â”‚
    â””â”€â”€â†’ Traces â”€â”€â†’ Jaeger/OpenTelemetry
```

## ðŸŽ¯ Performance Optimization

### Database Optimization
- Indexes on frequently queried columns
- Connection pooling
- Prepared statements
- Query optimization

### API Optimization
- Response caching
- Pagination
- Selective field loading
- Batch operations

### Frontend Optimization
- Code splitting
- Lazy loading
- Asset optimization
- Service worker caching

---

**This architecture supports:**
- âœ… High availability
- âœ… Horizontal scaling
- âœ… Data integrity
- âœ… Security
- âœ… Performance
- âœ… Maintainability

ðŸ“šâœ¨ Built for Growth!
